# Bulk ATAC-seq pipeline using UofA HPC
## This pipeline aims to generate an array of PBS files to analyze bulk ATAC-seq data in parallel.
### First, you need to define the PATH for your output directory and the variable for your project name.
```
OUTDIR=/path/to/your/output/dir
project_name=your_project_name
```
### Then, make a folder in your home directory to save the PBS files which will be generated by this pipeline.
```
mkdir /path/to/your/home/dir/${project_name}
```
### Generate PBS files using either human or mouse PBS template provided in this repo.
Use the template of bATAC_pipeline_single_job_mm.sh to generate PBS files for analyzing mouse data and use bATAC_pipeline_single_job_hs.sh to generate PBS files for analyzing human data.

This pipeline assumes that the fastq files have been saved in $OUTDIR/fastqs folder and are in a *_R1_001.fastq.gz format.

Here is the example to generate PBS files for analyzing mouse data.
```
for file in $OUTDIR/fastqs/*_R1_001.fastq.gz
do
	base=$(basename ${file} _R1_001.fastq.gz)
	fastq1=${base}_R1_001.fastq.gz
	fastq2=${base}_R2_001.fastq.gz
	sed "5 s/bATAC/$base/" /rsgrps/cusanovichlab/sbin/git.repo/arrayPBS_bATAC/bATAC_pipeline_single_job_mm.sh > /path/to/your/home/dir/${project_name}/bATAC_pipeline_${base}.sh
	sed -i "26 s/fastq1/$fastq1/2" /path/to/your/home/dir/${project_name}/bATAC_pipeline_${base}.sh
	sed -i "27 s/fastq2/$fastq2/2" /path/to/your/home/dir/${project_name}/bATAC_pipeline_${base}.sh
	sed -i "28 s/base/$base/2" /path/to/your/home/dir/${project_name}/bATAC_pipeline_${base}.sh
	sed -i "29 s~OUTDIR~$OUTDIR~2" /path/to/your/home/dir/${project_name}/bATAC_pipeline_${base}.sh
	#qsub /path/to/your/home/dir/${project_name}/bATAC_pipeline_${base}.sh
done
```
